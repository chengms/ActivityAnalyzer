# Cursor é¡¹ç›®è§„åˆ™ - æ´»åŠ¨åˆ†æå™¨ (Activity Analyzer)

## ğŸš« é‡è¦ï¼šä¸è¦é€šè¿‡ Cursor å·¥å…·è¿è¡Œé•¿æ—¶é—´è¿›ç¨‹

### ç¦æ­¢çš„æ“ä½œ
- âŒ **ä¸è¦**ä½¿ç”¨ `run_terminal_cmd` å·¥å…·è¿è¡Œ `npm start` æˆ– `npm run dev`
- âŒ **ä¸è¦**åœ¨åå°è¿è¡Œ Electron åº”ç”¨ï¼ˆ`is_background: true`ï¼‰
- âŒ **ä¸è¦**ç­‰å¾… Electron åº”ç”¨"å®Œæˆ"ï¼ˆå®ƒä¼šæŒç»­è¿è¡Œï¼‰

### åŸå› 
Electron åº”ç”¨æ˜¯æŒç»­è¿è¡Œçš„è¿›ç¨‹ï¼Œä¸ä¼šè‡ªåŠ¨é€€å‡ºã€‚å¦‚æœé€šè¿‡ Cursor å·¥å…·è¿è¡Œï¼Œä¼šå¯¼è‡´ç•Œé¢å¡ä½ï¼Œå› ä¸ºå·¥å…·ä¼šç­‰å¾…å‘½ä»¤å®Œæˆï¼Œä½† Electron åº”ç”¨æ°¸è¿œä¸ä¼š"å®Œæˆ"ã€‚

---

## âœ… æ­£ç¡®çš„æ“ä½œæ–¹å¼

### 1. è¿è¡Œ Electron åº”ç”¨
**åº”è¯¥ï¼š** å‘Šè¯‰ç”¨æˆ·åœ¨ç‹¬ç«‹ç»ˆç«¯ä¸­è¿è¡Œ
```bash
# åœ¨ç”¨æˆ·çš„ç‹¬ç«‹ç»ˆç«¯ä¸­è¿è¡Œ
npm start
```

**æˆ–è€…ï¼š** ä½¿ç”¨å¯åŠ¨è„šæœ¬
```bash
# å‘Šè¯‰ç”¨æˆ·åŒå‡» start-app.bat
```

### 2. æ„å»ºå‘½ä»¤
**å¯ä»¥ï¼š** åœ¨ Cursor å·¥å…·ä¸­è¿è¡Œï¼ˆé€šå¸¸å¾ˆå¿«å®Œæˆï¼‰
```bash
npm run build
npm run build:main
npm run build:renderer
```

### 3. æµ‹è¯•å’Œæ£€æŸ¥
**å¯ä»¥ï¼š** è¿è¡Œå¿«é€Ÿæ£€æŸ¥å‘½ä»¤
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
Test-Path dist\main\main.js

# æ£€æŸ¥è¿›ç¨‹
Get-Process | Where-Object {$_.ProcessName -like "*electron*"}

# ç¼–è¯‘æ£€æŸ¥
npx tsc -p tsconfig.main.json
```

---

## ğŸ“‹ ä»£ç ç¼–è¾‘è§„åˆ™

### TypeScript é…ç½®
- ä¸»è¿›ç¨‹ä»£ç åœ¨ `src/main/`ã€`src/tracker/`ã€`src/reporter/`ã€`src/settings/`
- æ¸²æŸ“è¿›ç¨‹ä»£ç åœ¨ `src/renderer/`
- ä½¿ç”¨ `tsconfig.main.json` ç¼–è¯‘ä¸»è¿›ç¨‹
- ä½¿ç”¨ Vite æ„å»ºæ¸²æŸ“è¿›ç¨‹

### å¯¼å…¥è§„åˆ™
- ä¸»è¿›ç¨‹ä½¿ç”¨ CommonJSï¼š`require()` å’Œ `module.exports`
- æ¸²æŸ“è¿›ç¨‹ä½¿ç”¨ ES6ï¼š`import` å’Œ `export`
- æ³¨æ„ï¼š`better-sqlite3` å¯¼å…¥ä¸º `DatabaseLib` é¿å…ä¸æˆ‘ä»¬çš„ `Database` ç±»å†²çª

### è·¯å¾„è§„åˆ™
- Vite é…ç½®å¿…é¡»è®¾ç½® `base: './'` ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆé€‚é… Electronï¼‰
- ä¸»è¿›ç¨‹ä½¿ç”¨ `path.join(__dirname, ...)` æ„å»ºè·¯å¾„
- æ¸²æŸ“è¿›ç¨‹ä½¿ç”¨ç›¸å¯¹è·¯å¾„ `./assets/...`

---

## ğŸ”§ è°ƒè¯•å’Œæµ‹è¯•

### æ·»åŠ è°ƒè¯•æ—¥å¿—
åœ¨å…³é”®ä½ç½®æ·»åŠ  `console.log()` å¸®åŠ©è°ƒè¯•ï¼š
```typescript
console.log('App ready, initializing...');
console.log('Settings initialized');
console.log('Database initialized');
```

### é”™è¯¯å¤„ç†
æ‰€æœ‰å¼‚æ­¥æ“ä½œéƒ½åº”è¯¥æœ‰ try-catchï¼š
```typescript
try {
  // æ“ä½œ
} catch (error) {
  console.error('Error:', error);
  // å¤„ç†é”™è¯¯
}
```

### è¿›ç¨‹æ£€æŸ¥
å¦‚æœéœ€è¦æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿è¡Œï¼š
```powershell
Get-Process | Where-Object {$_.ProcessName -like "*electron*"}
```

---

## ğŸ“¦ ä¾èµ–ç®¡ç†

### better-sqlite3 ç‰¹æ®Šå¤„ç†
- å¦‚æœç¼–è¯‘å¤±è´¥ï¼Œä½¿ç”¨ï¼š`npm install better-sqlite3 --build-from-source=false`
- éœ€è¦ `@types/better-sqlite3` ç±»å‹å®šä¹‰
- å¯¼å…¥æ—¶ä½¿ç”¨åˆ«åé¿å…å†²çªï¼š`import DatabaseLib from 'better-sqlite3'`

### å®‰è£…ä¾èµ–
```bash
npm install --ignore-scripts  # è·³è¿‡ç¼–è¯‘è„šæœ¬
npm install better-sqlite3 --build-from-source=false  # ä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬
```

---

## ğŸ¯ æ–‡ä»¶ç»“æ„è§„åˆ™

### å¿…é¡»å­˜åœ¨çš„æ–‡ä»¶
- `src/main/main.ts` - Electron ä¸»è¿›ç¨‹å…¥å£
- `src/main/preload.ts` - é¢„åŠ è½½è„šæœ¬
- `src/renderer/App.tsx` - React ä¸»ç»„ä»¶
- `src/tracker/tracker.ts` - æ´»åŠ¨è¿½è¸ªå™¨
- `src/tracker/database.ts` - æ•°æ®åº“æ“ä½œ
- `src/settings/settings.ts` - è®¾ç½®ç®¡ç†
- `src/reporter/reporter.ts` - æŠ¥å‘Šç”Ÿæˆ

### æ„å»ºè¾“å‡º
- `dist/main/` - ä¸»è¿›ç¨‹ç¼–è¯‘è¾“å‡º
- `dist/renderer/` - æ¸²æŸ“è¿›ç¨‹æ„å»ºè¾“å‡º

---

## âš ï¸ å¸¸è§é—®é¢˜å¤„ç†

### é—®é¢˜ 1: åº”ç”¨å¡ä½
**åŸå› ï¼š** é€šè¿‡ Cursor å·¥å…·è¿è¡Œäº† `npm start`
**è§£å†³ï¼š** å‘Šè¯‰ç”¨æˆ·åœ¨ç‹¬ç«‹ç»ˆç«¯è¿è¡Œï¼Œæˆ–ä½¿ç”¨ `start-app.bat`

### é—®é¢˜ 2: èµ„æºåŠ è½½å¤±è´¥
**åŸå› ï¼š** Vite é…ç½®ç¼ºå°‘ `base: './'`
**è§£å†³ï¼š** ç¡®ä¿ `vite.config.ts` ä¸­æœ‰ `base: './'`

### é—®é¢˜ 3: TypeScript ç¼–è¯‘é”™è¯¯
**åŸå› ï¼š** `rootDir` é…ç½®ä¸æ­£ç¡®
**è§£å†³ï¼š** `tsconfig.main.json` ä¸­ `rootDir` åº”è¯¥æ˜¯ `"./src"`ï¼Œ`outDir` åº”è¯¥æ˜¯ `"./dist"`

### é—®é¢˜ 4: better-sqlite3 ç¼–è¯‘å¤±è´¥
**åŸå› ï¼š** ç¼ºå°‘ C++ ç¼–è¯‘å·¥å…·æˆ–ç‰ˆæœ¬ä¸å…¼å®¹
**è§£å†³ï¼š** ä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬æˆ–å®‰è£… Visual Studio Build Tools

---

## ğŸš€ å¯åŠ¨åº”ç”¨çš„æ ‡å‡†æµç¨‹

### å¼€å‘æ¨¡å¼ï¼ˆå‘Šè¯‰ç”¨æˆ·ï¼‰
```bash
# 1. æ‰“å¼€ç‹¬ç«‹ç»ˆç«¯
# 2. è¿è¡Œ
npm run dev
```

### ç”Ÿäº§æ¨¡å¼ï¼ˆå‘Šè¯‰ç”¨æˆ·ï¼‰
```bash
# 1. æ„å»º
npm run build

# 2. åœ¨ç‹¬ç«‹ç»ˆç«¯è¿è¡Œ
npm start
```

### æˆ–è€…ä½¿ç”¨è„šæœ¬
```bash
# åŒå‡» start-app.bat
```

---

## ğŸ“ ä»£ç è§„èŒƒ

### é”™è¯¯å¤„ç†æ¨¡å¼
```typescript
// âœ… æ­£ç¡®
try {
  const result = await someAsyncOperation();
  return result;
} catch (error) {
  console.error('Operation failed:', error);
  return null; // æˆ–æŠ›å‡ºé”™è¯¯
}

// âŒ é”™è¯¯
const result = await someAsyncOperation(); // æ²¡æœ‰é”™è¯¯å¤„ç†
```

### ç±»å‹å®‰å…¨
```typescript
// âœ… æ­£ç¡®
let trayIcon: Electron.NativeImage = nativeImage.createEmpty();

// âŒ é”™è¯¯
let trayIcon: Electron.NativeImage; // æœªåˆå§‹åŒ–
```

### IPC é€šä¿¡
```typescript
// ä¸»è¿›ç¨‹
ipcMain.handle('get-settings', async () => {
  if (!settings) return null;
  return settings.getSettings();
});

// æ¸²æŸ“è¿›ç¨‹ï¼ˆé€šè¿‡ preloadï¼‰
window.electronAPI.getSettings()
```

---

## ğŸ“ æœ€ä½³å®è·µæ€»ç»“

1. **è¿è¡Œåº”ç”¨ï¼š** æ°¸è¿œåœ¨ç‹¬ç«‹ç»ˆç«¯ä¸­è¿è¡Œï¼Œä¸è¦é€šè¿‡ Cursor å·¥å…·
2. **æ„å»ºé¡¹ç›®ï¼š** å¯ä»¥åœ¨ Cursor å·¥å…·ä¸­è¿è¡Œï¼ˆé€šå¸¸å¾ˆå¿«ï¼‰
3. **æ£€æŸ¥çŠ¶æ€ï¼š** ä½¿ç”¨å¿«é€Ÿæ£€æŸ¥å‘½ä»¤ï¼Œä¸è¦ç­‰å¾…é•¿æ—¶é—´è¿›ç¨‹
4. **é”™è¯¯å¤„ç†ï¼š** æ‰€æœ‰å¼‚æ­¥æ“ä½œéƒ½è¦æœ‰é”™è¯¯å¤„ç†
5. **ç±»å‹å®‰å…¨ï¼š** ç¡®ä¿æ‰€æœ‰å˜é‡åœ¨ä½¿ç”¨å‰å·²åˆå§‹åŒ–
6. **è·¯å¾„é…ç½®ï¼š** Electron åº”ç”¨å¿…é¡»ä½¿ç”¨ç›¸å¯¹è·¯å¾„

---

## ğŸ” è°ƒè¯•æ£€æŸ¥æ¸…å•

å½“ç”¨æˆ·æŠ¥å‘Šé—®é¢˜æ—¶ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºæ£€æŸ¥ï¼š

1. âœ… æ„å»ºæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Ÿ (`dist/main/main.js`, `dist/renderer/index.html`)
2. âœ… TypeScript ç¼–è¯‘æ˜¯å¦æˆåŠŸï¼Ÿ (`npx tsc -p tsconfig.main.json`)
3. âœ… ä¾èµ–æ˜¯å¦å®‰è£…ï¼Ÿ (`Test-Path node_modules`)
4. âœ… better-sqlite3 æ˜¯å¦æ­£å¸¸ï¼Ÿ (`node -e "require('better-sqlite3')"`)
5. âœ… åº”ç”¨æ˜¯å¦åœ¨è¿è¡Œï¼Ÿ (`Get-Process | Where-Object {$_.ProcessName -like "*electron*"}`)
6. âœ… æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—ï¼Ÿ (æ£€æŸ¥æ§åˆ¶å°è¾“å‡º)

---

## ğŸ“Œ é‡è¦æé†’

**æ°¸è¿œè®°ä½ï¼š**
- Electron åº”ç”¨æ˜¯æŒç»­è¿è¡Œçš„è¿›ç¨‹
- ä¸è¦é€šè¿‡ Cursor å·¥å…·è¿è¡Œ `npm start` æˆ– `npm run dev`
- å‘Šè¯‰ç”¨æˆ·åœ¨ç‹¬ç«‹ç»ˆç«¯ä¸­è¿è¡Œ
- æˆ–è€…æä¾›å¯åŠ¨è„šæœ¬ï¼ˆå¦‚ `start-app.bat`ï¼‰

